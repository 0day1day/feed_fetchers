import requests
import re
import csv

# User defined variables
feedaddr = 'http://www.malwaredomainlist.com/updatescsv.php'
feedID = 'malwaredomainlist'
killchain = 'Exploit'

r = requests.get(feedaddr)
splitlines = r.content.split('\n')

print('domain,feedID,killchain,description,date,domain_url,ipv4_url,reverse_dns,category,abuse_contact,context')

csvreader = csv.reader(splitlines, delimiter=',', quotechar='"')
for row in csvreader:
	if len(row) == 0: continue # Skip any blank lines
	if row[0] == '-': row[0] = ''
	if row[1] == '-': row[1] = ''
	if row[2] == '-': row[2] = ''
	if row[3] == '-': row[3] = ''
	if row[4] == '-': row[4] = ''
	if row[5] == '-': row[5] = ''
	if row[6] == '-': row[6] = ''
	if not re.search('[a-z,A-Z]', row[1]): continue
	domain = re.sub('\/.*', '', row[1])
	row[5] = re.sub(',', '', row[5])
	print("%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s" % (domain, feedID, killchain, 'Malwaredomainlist bad domains', row[0], row[1], row[2], row[3], row[4], row[5], row[6]))